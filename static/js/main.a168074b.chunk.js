(this.webpackJsonpmessanger=this.webpackJsonpmessanger||[]).push([[0],{31:function(e,t,n){e.exports={chat:"styles_chat__23nrG",messageContainer:"styles_messageContainer__3KnPr",send:"styles_send__3WBd0",myMessage:"styles_myMessage__3QpBI",message:"styles_message__3C9ZM",messageInner:"styles_messageInner__hTHv1",name:"styles_name__4yeO6",text:"styles_text__2LEyL",time:"styles_time__rLBsW"}},34:function(e,t,n){e.exports={sidebar:"styles_sidebar__16trl",adding:"styles_adding__3hh25",rooms:"styles_rooms__3tvlm",room:"styles_room__3mWb0",roomActive:"styles_roomActive__2D0bO",signOut:"styles_signOut__RlJtr"}},58:function(e,t,n){},59:function(e,t,n){},67:function(e,t,n){"use strict";n.r(t);var s=n(10),a=n.n(s),r=n(41),c=n.n(r),o=(n(58),n(59),n(16)),i=n(34),u=n.n(i),d=n(30),l=n(0),m=n.n(l),j=n(3),b=n(28),f=n(33);f.a.initializeApp({apiKey:"AIzaSyAghmcGT8Vx9NJYaJJrQZv9KGGQJoSrj3M",authDomain:"messanger-d22bd.firebaseapp.com",projectId:"messanger-d22bd",storageBucket:"messanger-d22bd.appspot.com",messagingSenderId:"924028479563",appId:"1:924028479563:web:d969696cf156cdb9e305ce",measurementId:"G-LL04W52QS6"});var h=f.a.firestore(),p=f.a.auth(),g=new f.a.auth.GoogleAuthProvider,O=h,v=Object(b.b)("fetchRooms/roomsSlice",function(){var e=Object(j.a)(m.a.mark((function e(t,n){var s,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=n.dispatch,a=[],O.collection("rooms").onSnapshot((function(e){a=e.docs.map((function(e){return{id:e.id,data:e.data()}})),s(w(a))}));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),x=Object(b.b)("addRoom/roomsSlice",function(){var e=Object(j.a)(m.a.mark((function e(t,n){var s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.dispatch,e.next=3,O.collection("rooms").add({name:t});case 3:s(v());case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),_=Object(b.b)("getMessages/roomsSlice",function(){var e=Object(j.a)(m.a.mark((function e(t,n){var s,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=n.dispatch,a=[],O.collection("rooms").doc(t).collection("messages").orderBy("time","asc").onSnapshot((function(e){a=e.docs.map((function(e){return{id:e.id,data:e.data()}})),s(N(a))})),s(k(t));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),y=Object(b.b)("setMessage/roomsSlice",(function(e){var t=e.roomId,n=e.message;console.log({roomId:t,message:n}),O.collection("rooms").doc(t).collection("messages").add(n).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)}))})),I=Object(b.c)({name:"roomsSlice",initialState:{rooms:[],messages:[],loading:!1,roomId:"",errorMessage:""},reducers:{setRooms:function(e,t){e.rooms=t.payload},setMessages:function(e,t){e.messages=t.payload},setCurrentRoom:function(e,t){e.roomId=t.payload}}}),S=I.reducer,C=I.actions,w=C.setRooms,N=C.setMessages,k=C.setCurrentRoom,M=Object(b.b)("authSlice/signIn",function(){var e=Object(j.a)(m.a.mark((function e(t,n){var s,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.dispatch,e.next=3,p.signInWithPopup(g);case 3:a=e.sent,s(L(a.user));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),A=Object(b.b)("authSlice/signIn",function(){var e=Object(j.a)(m.a.mark((function e(t,n){var s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.dispatch,e.next=3,p.signOut();case 3:s(L({}));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),R=Object(b.b)("authSlice/authChecking",(function(e,t){var n=t.dispatch;p.onAuthStateChanged((function(e){e&&n(L(p.currentUser))}))})),B=Object(b.c)({name:"auth",initialState:{user:{},loading:!1,errorMessage:""},reducers:{setUser:function(e,t){e.user=t.payload}}}),J=B.reducer,L=B.actions.setUser,D=n(15),F=function(){var e=Object(d.b)(),t=Object(d.c)((function(e){return e.rooms})),n=t.rooms,a=t.roomId,r=Object(s.useState)(""),c=Object(o.a)(r,2),i=c[0],l=c[1];return Object(D.jsxs)("div",{className:u.a.sidebar,children:[Object(D.jsxs)("div",{children:[Object(D.jsxs)("div",{className:u.a.adding,children:[Object(D.jsx)("input",{value:i,placeholder:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043e\u043c\u043d\u0430\u0442\u0443",onChange:function(e){return l(e.target.value)}}),Object(D.jsx)("button",{onClick:function(){return e(x(i))},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})]}),Object(D.jsx)("div",{className:u.a.rooms,children:n.map((function(t){var n;return Object(D.jsx)("div",{className:a===t.id?u.a.roomActive:u.a.room,onClick:function(){return e(_(t.id))},children:null===(n=t.data)||void 0===n?void 0:n.name},t.id)}))})]}),Object(D.jsx)("button",{className:u.a.signOut,onClick:function(){return e(A())},children:"\u0412\u044b\u0439\u0442\u0438"})]})},G=n(31),T=n.n(G),P=function(){var e=Object(s.useRef)();return Object(s.useEffect)((function(){return e.current.scrollIntoView()})),Object(D.jsx)("div",{ref:e})},W=function(){var e=Object(d.b)(),t=Object(d.c)((function(e){return e.rooms})),n=t.messages,a=t.roomId,r=Object(d.c)((function(e){return e.auth.user})),c=Object(s.useState)(""),i=Object(o.a)(c,2),u=i[0],l=i[1];return Object(D.jsxs)("div",{className:T.a.chat,children:[Object(D.jsxs)("div",{className:T.a.messageContainer,children:[n.map((function(e){var t,n;return Object(D.jsx)("div",{className:e.data.uid===r.uid?T.a.myMessage:T.a.message,children:Object(D.jsxs)("div",{className:T.a.messageInner,children:[Object(D.jsx)("div",{className:T.a.name,children:e.data.name}),Object(D.jsx)("p",{className:T.a.text,children:e.data.message}),Object(D.jsx)("span",{className:T.a.time,children:new Date(null===(t=e.data)||void 0===t||null===(n=t.time)||void 0===n?void 0:n.toDate()).toUTCString()})]})},e.id)})),Object(D.jsx)(P,{})]}),a&&Object(D.jsxs)("div",{className:T.a.send,children:[Object(D.jsx)("input",{type:"text",value:u,placeholder:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",onChange:function(e){return l(e.target.value)}}),Object(D.jsx)("button",{onClick:function(t){return function(t){t.preventDefault();var n={name:r.displayName,audio:"",image:"",message:u,uid:r.uid,time:f.a.firestore.FieldValue.serverTimestamp()};e(y({roomId:a,message:n}))}(t)},children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]})]})};var E=function(){var e=Object(d.b)(),t=Object(d.c)((function(e){return e.auth.user}));return Object(s.useEffect)((function(){e(v()),e(R())}),[e]),Object(D.jsx)("div",{className:"App",children:Object.keys(t).length?Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(F,{}),Object(D.jsx)(W,{})]}):Object(D.jsx)("div",{className:"auth",children:Object(D.jsx)("button",{onClick:function(){return e(M())},children:"\u0417\u0430\u0440\u0435\u0433\u0430\u0439\u0441\u044f"})})})},Q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,68)).then((function(t){var n=t.getCLS,s=t.getFID,a=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),s(e),a(e),r(e),c(e)}))},U=Object(b.a)({reducer:{auth:J,rooms:S},middleware:function(e){return e({serializableCheck:!1})}}),z=n(53);c.a.render(Object(D.jsx)(d.a,{store:U,children:Object(D.jsx)(z.a,{children:Object(D.jsx)(a.a.StrictMode,{children:Object(D.jsx)(E,{})})})}),document.getElementById("root")),Q()}},[[67,1,2]]]);
//# sourceMappingURL=main.a168074b.chunk.js.map