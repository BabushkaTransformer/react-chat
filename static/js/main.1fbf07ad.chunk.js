(this.webpackJsonpmessanger=this.webpackJsonpmessanger||[]).push([[0],{31:function(e,t,n){e.exports={chat:"styles_chat__23nrG",messageContainer:"styles_messageContainer__3KnPr",send:"styles_send__3WBd0",myMessage:"styles_myMessage__3QpBI",message:"styles_message__3C9ZM",messageInner:"styles_messageInner__hTHv1",name:"styles_name__4yeO6",text:"styles_text__2LEyL",time:"styles_time__rLBsW"}},34:function(e,t,n){e.exports={sidebar:"styles_sidebar__16trl",adding:"styles_adding__3hh25",rooms:"styles_rooms__3tvlm",room:"styles_room__3mWb0",roomActive:"styles_roomActive__2D0bO",signOut:"styles_signOut__RlJtr"}},58:function(e,t,n){},59:function(e,t,n){},67:function(e,t,n){"use strict";n.r(t);var s=n(10),a=n.n(s),r=n(41),c=n.n(r),o=(n(58),n(15)),i=(n(59),n(34)),u=n.n(i),d=n(30),l=n(0),m=n.n(l),j=n(3),b=n(28),f=n(33);f.a.initializeApp({apiKey:"AIzaSyAghmcGT8Vx9NJYaJJrQZv9KGGQJoSrj3M",authDomain:"messanger-d22bd.firebaseapp.com",projectId:"messanger-d22bd",storageBucket:"messanger-d22bd.appspot.com",messagingSenderId:"924028479563",appId:"1:924028479563:web:d969696cf156cdb9e305ce",measurementId:"G-LL04W52QS6"});var h=f.a.firestore(),p=f.a.auth(),g=new f.a.auth.GoogleAuthProvider,O=h,v=Object(b.b)("fetchRooms/roomsSlice",function(){var e=Object(j.a)(m.a.mark((function e(t,n){var s,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=n.dispatch,a=[],O.collection("rooms").onSnapshot((function(e){a=e.docs.map((function(e){return{id:e.id,data:e.data()}})),s(N(a))}));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),x=Object(b.b)("addRoom/roomsSlice",function(){var e=Object(j.a)(m.a.mark((function e(t,n){var s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.dispatch,e.next=3,O.collection("rooms").add({name:t});case 3:s(v());case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),_=Object(b.b)("getMessages/roomsSlice",function(){var e=Object(j.a)(m.a.mark((function e(t,n){var s,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=n.dispatch,a=[],O.collection("rooms").doc(t).collection("messages").orderBy("time","asc").onSnapshot((function(e){a=e.docs.map((function(e){return{id:e.id,data:e.data()}})),s(w(a))})),s(k(t));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),y=Object(b.b)("setMessage/roomsSlice",(function(e){var t=e.roomId,n=e.message;console.log({roomId:t,message:n}),O.collection("rooms").doc(t).collection("messages").add(n).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)}))})),S=Object(b.c)({name:"roomsSlice",initialState:{rooms:[],messages:[],loading:!1,roomId:"",errorMessage:""},reducers:{setRooms:function(e,t){e.rooms=t.payload},setMessages:function(e,t){e.messages=t.payload},setCurrentRoom:function(e,t){e.roomId=t.payload}}}),I=S.reducer,C=S.actions,N=C.setRooms,w=C.setMessages,k=C.setCurrentRoom,M=(Object(b.b)("authSlice/signIn",function(){var e=Object(j.a)(m.a.mark((function e(t,n){var s,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.dispatch,e.next=3,p.signInWithPopup(g);case 3:a=e.sent,s(B(a.user));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),Object(b.b)("authSlice/signIn",function(){var e=Object(j.a)(m.a.mark((function e(t,n){var s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.dispatch,e.next=3,p.signOut();case 3:s(B({}));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())),J=Object(b.b)("authSlice/authChecking",(function(e,t){var n=t.dispatch,s=JSON.parse(localStorage.getItem("user")||"{}");n(B(s))})),A=Object(b.c)({name:"auth",initialState:{user:{},loading:!1,errorMessage:""},reducers:{setUser:function(e,t){localStorage.setItem("user",JSON.stringify(t.payload)),e.user=t.payload}}}),R=A.reducer,B=A.actions.setUser,L=n(16),D=function(){var e=Object(d.b)(),t=Object(d.c)((function(e){return e.rooms})),n=t.rooms,a=t.roomId,r=Object(s.useState)(""),c=Object(o.a)(r,2),i=c[0],l=c[1];return Object(L.jsxs)("div",{className:u.a.sidebar,children:[Object(L.jsxs)("div",{children:[Object(L.jsxs)("div",{className:u.a.adding,children:[Object(L.jsx)("input",{value:i,placeholder:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043e\u043c\u043d\u0430\u0442\u0443",onChange:function(e){return l(e.target.value)}}),Object(L.jsx)("button",{onClick:function(){return e(x(i))},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})]}),Object(L.jsx)("div",{className:u.a.rooms,children:n.map((function(t){var n;return Object(L.jsx)("div",{className:a===t.id?u.a.roomActive:u.a.room,onClick:function(){return e(_(t.id))},children:null===(n=t.data)||void 0===n?void 0:n.name},t.id)}))})]}),Object(L.jsx)("button",{className:u.a.signOut,onClick:function(){return e(M())},children:"\u0412\u044b\u0439\u0442\u0438"})]})},F=n(31),G=n.n(F),T=function(){var e=Object(s.useRef)();return Object(s.useEffect)((function(){return e.current.scrollIntoView()})),Object(L.jsx)("div",{ref:e})},P=function(){var e=Object(d.b)(),t=Object(d.c)((function(e){return e.rooms})),n=t.messages,a=t.roomId,r=Object(d.c)((function(e){return e.auth.user})),c=Object(s.useState)(""),i=Object(o.a)(c,2),u=i[0],l=i[1];console.log(r);return Object(L.jsxs)("div",{className:G.a.chat,children:[Object(L.jsxs)("div",{className:G.a.messageContainer,children:[n.map((function(e){var t,n;return Object(L.jsx)("div",{className:e.data.name===r.name?G.a.myMessage:G.a.message,children:Object(L.jsxs)("div",{className:G.a.messageInner,children:[Object(L.jsx)("div",{className:G.a.name,children:e.data.name}),Object(L.jsx)("p",{className:G.a.text,children:e.data.message}),Object(L.jsx)("span",{className:G.a.time,children:new Date(null===(t=e.data)||void 0===t||null===(n=t.time)||void 0===n?void 0:n.toDate()).toUTCString()})]})},e.id)})),Object(L.jsx)(T,{})]}),a&&Object(L.jsxs)("div",{className:G.a.send,children:[Object(L.jsx)("input",{type:"text",value:u,placeholder:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",onChange:function(e){return l(e.target.value)}}),Object(L.jsx)("button",{onClick:function(t){return function(t){t.preventDefault();var n={name:r.name,audio:"",image:"",message:u,time:f.a.firestore.FieldValue.serverTimestamp()};e(y({roomId:a,message:n}))}(t)},children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]})]})};var W=function(){var e=Object(d.b)(),t=Object(s.useState)(),n=Object(o.a)(t,2),a=n[0],r=n[1],c=Object(d.c)((function(e){return e.auth.user}));return Object(s.useEffect)((function(){e(v()),e(J())}),[e]),Object(L.jsx)("div",{className:"App",children:Object.keys(c).length?Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(D,{}),Object(L.jsx)(P,{})]}):Object(L.jsxs)("div",{className:"auth",children:[Object(L.jsx)("input",{type:"text",value:a,placeholder:"\u0418\u043c\u044f \u043f\u0438\u0448\u0438",onChange:function(e){return r(e.target.value)}}),Object(L.jsx)("button",{onClick:function(){a&&e(B({name:a}))},children:"\u0417\u0430\u0440\u0435\u0433\u0430\u0439\u0441\u044f"})]})})},E=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,68)).then((function(t){var n=t.getCLS,s=t.getFID,a=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),s(e),a(e),r(e),c(e)}))},Q=Object(b.a)({reducer:{auth:R,rooms:I},middleware:function(e){return e({serializableCheck:!1})}}),z=n(53);c.a.render(Object(L.jsx)(d.a,{store:Q,children:Object(L.jsx)(z.a,{children:Object(L.jsx)(a.a.StrictMode,{children:Object(L.jsx)(W,{})})})}),document.getElementById("root")),E()}},[[67,1,2]]]);
//# sourceMappingURL=main.1fbf07ad.chunk.js.map